{% extends "index.html" %}
{% block content %}
  <h2>View Scan Results</h2>
  <form method="post" style="margin-bottom:1em;">
    <label for="scan_id">Scan Folder Name (e.g. scan-xxxx...):</label>
    <input type="text" id="scan_id" name="scan_id" value="{{ scan_id or '' }}" required autocomplete="off">
    <button type="submit">View Results</button>
    <button type="button" onclick="window.location.href='/view-results'">Reset</button>
  </form>
  {% if error %}
    <div style="color: red; margin-top: 1em;">Error: {{ error }}</div>
  {% endif %}
  {% if findings %}
    <h3>Findings</h3>
    <a href="/download-findings/{{ scan_id }}" style="display:inline-block;margin-bottom:1em;" download>
      <button type="button">Download findings.json</button>
    </a>
    <table border="1" cellpadding="5" style="margin-top:1em;">
      <tr>
        <th>Name</th>
        <th>Description</th>
        <th>Category</th>
        <th>Location</th>
        <th>Severity</th>
        <th>Attributes</th>
      </tr>
      {% for finding in findings %}
      <tr>
        <td>{{ finding.name }}</td>
        <td>{{ finding.description }}</td>
        <td>{{ finding.category }}</td>
        <td>{{ finding.location }}</td>
        <td>{{ finding.severity }}</td>
        <td><pre style="white-space: pre-wrap;">{{ finding.attributes | tojson(indent=2) }}</pre></td>
      </tr>
      {% endfor %}
    </table>
  {% endif %}
{% endblock %} 